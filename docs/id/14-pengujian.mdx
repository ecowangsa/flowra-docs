---
id: testing
slug: /testing/overview
sidebar_position: 14
---

# Strategi Pengujian

## Menjalankan test
Proyek Flowra dilengkapi konfigurasi Jest di `package.json`:

```json
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage"
  }
}
```

Jalankan seluruh suite dengan `npm test`. Gunakan `npm run test:watch` saat mengerjakan modul.

## Scaffold test
Gunakan CLI untuk membuat file test:

```bash
npx flowra make:test users/user-service --type unit
npx flowra make:test users/user-controller --type integration
```

Generator menaruh berkas di `tests/<module>/` dan menyiapkan application test module.

## Menguji service
`core/testing/application-test-module.ts` menyalakan container dengan opsi override.

```ts
import {createTestApplication} from '../../core/testing/application-test-module';
import {UsersModule} from '../../app/modules/users';
import {UserService} from '../../app/modules/users/services/user.service';

describe('UserService', () => {
  it('creates a user', async () => {
    const app = await createTestApplication({modules: [UsersModule]});
    const service = app.container.resolve(UserService);

    const user = await service.create({email: 'ada@example.com', name: 'Ada'});
    expect(user.email).toBe('ada@example.com');
  });
});
```

Override dependensi per test:

```ts
const app = await createTestApplication({
  modules: [UsersModule],
  overrides: [
    {
      token: 'Database.primary',
      useValue: inMemoryDatabase,
    },
  ],
});
```

## Menguji endpoint HTTP
Integration test menggunakan SuperTest atau helper HTTP Flowra:

```ts
import request from 'supertest';
import {createHttpTestApp} from '../../core/testing/http-test-app';

const app = await createHttpTestApp({modules: [UsersModule]});

await request(app.getHttpServer())
  .post('/users')
  .send({email: 'ada@example.com', name: 'Ada'})
  .expect(201);
```

## Struktur test yang dianjurkan
```
tests/
├─ users/
│  ├─ user-service.spec.ts
│  └─ user-controller.spec.ts
├─ billing/
│  └─ invoice-service.spec.ts
└─ support/
   └─ fixtures/
```

## Jika test belum ada
Jika proyek belum memiliki test, gunakan baseline berikut:

- **Unit test** – cakup service dan helper dengan Jest + override container.
- **Integration test** – uji endpoint HTTP via SuperTest dan bootstrap aplikasi test.
- **Database test** – jalankan di database ephemeris (SQLite, Docker) dengan migrasi sebelum suite (`npx flowra migrate`).
- **Factory/fixture** – buat factory di `tests/support/factories` untuk mengurangi duplikasi.

> **note**
> Gunakan `npm run test:coverage` untuk menjaga modul kritis sesuai target coverage yang disepakati tim.
