"use strict";(globalThis.webpackChunkflowra_docs=globalThis.webpackChunkflowra_docs||[]).push([[33],{1658:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"routing/routes-and-controllers","title":"Routes & Controllers","description":"Define Express routes inside modules and resolve controllers from the container.","source":"@site/docs/routing/routes-and-controllers.mdx","sourceDirName":"routing","slug":"/routing/routes-and-controllers","permalink":"/docs/routing/routes-and-controllers","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Routes & Controllers","description":"Define Express routes inside modules and resolve controllers from the container."},"sidebar":"docsSidebar","previous":{"title":"Modules","permalink":"/docs/architecture/modules"},"next":{"title":"Validation & Errors","permalink":"/docs/routing/validation-and-errors"}}');var o=n(4848),t=n(8453);const l={title:"Routes & Controllers",description:"Define Express routes inside modules and resolve controllers from the container."},i=void 0,c={},u=[{value:"Defining routes",id:"defining-routes",level:2},{value:"Controllers",id:"controllers",level:2},{value:"Rendering views",id:"rendering-views",level:2}];function a(e){const r={code:"code",h2:"h2",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.p,{children:"Flowra routes live inside modules. The HTTP router loops through all enabled modules and attaches their routes to Express."}),"\n",(0,o.jsx)(r.h2,{id:"defining-routes",children:"Defining routes"}),"\n",(0,o.jsx)(r.p,{children:"A route file receives both the Express router and the container:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-js",metastring:'title="app/Modules/Users/users.routes.js"',children:"'use strict';\nconst group = require('routergroup');\n\nfunction registerUsersRoutes({ router, container } = {}) {\n  if (!router || !container) {\n    return router;\n  }\n\n  const controller = container.resolve('modules.users.controllers.main');\n\n  router.use(\n    group('/users', (router) => {\n      router.get('/list', controller.list.bind(controller));\n      router.post('/create', controller.create.bind(controller));\n    })\n  );\n\n  return router;\n}\n\nmodule.exports = registerUsersRoutes;\n"})}),"\n",(0,o.jsxs)(r.p,{children:["Flowra uses ",(0,o.jsx)(r.code,{children:"routergroup"})," to keep route prefixes consistent, but you can use plain Express routes if you prefer."]}),"\n",(0,o.jsx)(r.h2,{id:"controllers",children:"Controllers"}),"\n",(0,o.jsx)(r.p,{children:"Controllers encapsulate request handling logic. They receive services via constructor injection:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-js",metastring:'title="app/Modules/Users/Users.controller.js"',children:"const BaseController = require('../Shared/controllers/BaseController');\nconst HttpError = require('../../Errors/HttpError');\n\nclass UsersController extends BaseController {\n  constructor({ logger, usersService } = {}) {\n    super({ logger });\n    this.logger = logger;\n    this.usersService = usersService;\n  }\n\n  list = async (req, res, next) => {\n    try {\n      const users = await this.usersService.list();\n      res.status(200).json({ message: 'Success', data: users });\n    } catch (error) {\n      if (!(error instanceof HttpError)) {\n        this.logger?.error('http.users.list.failed', { message: error.message });\n      }\n      next(error);\n    }\n  };\n}\n\nmodule.exports = UsersController;\n"})}),"\n",(0,o.jsx)(r.h2,{id:"rendering-views",children:"Rendering views"}),"\n",(0,o.jsx)(r.p,{children:"Modules can also render views. The Welcome module, for example, returns an EJS template:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-js",metastring:'title="app/Modules/Welcome/Welcome.controller.js"',children:"class WelcomeController {\n  async index(req, res, next) {\n    try {\n      const context = await this.welcomeService.getLandingPageContext();\n      return res.render('welcome', context);\n    } catch (error) {\n      next(error);\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:"Flowra keeps the routing layer thin so controllers and services stay focused on business logic."})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>i});var s=n(6540);const o={},t=s.createContext(o);function l(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);