"use strict";(globalThis.webpackChunkflowra_docs=globalThis.webpackChunkflowra_docs||[]).push([[665],{4212:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"data/knex-configuration","title":"Database Configuration","description":"Configure Knex connections and database aliases in Flowra.","source":"@site/docs/data/knex-configuration.mdx","sourceDirName":"data","slug":"/data/knex-configuration","permalink":"/docs/data/knex-configuration","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Database Configuration","description":"Configure Knex connections and database aliases in Flowra."},"sidebar":"docsSidebar","previous":{"title":"Validation & Errors","permalink":"/docs/routing/validation-and-errors"},"next":{"title":"Models & Queries","permalink":"/docs/data/models-and-queries"}}');var s=o(4848),i=o(8453);const t={title:"Database Configuration",description:"Configure Knex connections and database aliases in Flowra."},r=void 0,c={},d=[{value:"Default configuration",id:"default-configuration",level:2},{value:"Connection aliases",id:"connection-aliases",level:2},{value:"CLI configuration",id:"cli-configuration",level:2},{value:"Switching databases",id:"switching-databases",level:2}];function l(n){const e={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["Flowra uses Knex under the hood. Database configuration lives in ",(0,s.jsx)(e.code,{children:"app/Config/Database.js"})," and is consumed by the ",(0,s.jsx)(e.code,{children:"DatabaseManager"}),"."]}),"\n",(0,s.jsx)(e.h2,{id:"default-configuration",children:"Default configuration"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",metastring:'title="app/Config/Database.js"',children:"module.exports = {\n  default: 'default',\n  connections: {\n    default: {\n      client: 'mysql2',\n      connection: {\n        host: process.env.DB_MYSQL_HOST_PRIMARY || process.env.DB_MYSQL_HOST || '127.0.0.1',\n        user: process.env.DB_DEFAULT_USERNAME || 'root',\n        password: process.env.DB_DEFAULT_PASSWORD || '',\n        database: process.env.DB_DEFAULT_DATABASE || 'flowra',\n        port: parseInt(process.env.DB_MYSQL_PORT_PRIMARY || process.env.DB_MYSQL_PORT, 10),\n      },\n    },\n    defaultRead: {\n      client: 'mysql2',\n      connection: {\n        host: process.env.DB_MYSQL_HOST_READONLY || process.env.DB_MYSQL_HOST || '127.0.0.1',\n        user: process.env.DB_DEFAULT_USERNAME || 'root',\n        password: process.env.DB_DEFAULT_PASSWORD || '',\n        database: process.env.DB_DEFAULT_DATABASE || 'flowra',\n      },\n    },\n  },\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"connection-aliases",children:"Connection aliases"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"default"})," is the primary connection."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"defaultRead"})," is used for read operations when available."]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["Services and models can choose the connection alias via the ",(0,s.jsx)(e.code,{children:"Service"})," base class."]}),"\n",(0,s.jsx)(e.h2,{id:"cli-configuration",children:"CLI configuration"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"orm.cli.config.js"})," reads your database config and maps it to Knex CLI commands. You can override connection names with environment variables like ",(0,s.jsx)(e.code,{children:"KNEX_CONNECTION"}),"."]}),"\n",(0,s.jsx)(e.h2,{id:"switching-databases",children:"Switching databases"}),"\n",(0,s.jsxs)(e.p,{children:["To use PostgreSQL or another database, update the connection ",(0,s.jsx)(e.code,{children:"client"})," and ",(0,s.jsx)(e.code,{children:"connection"})," values in ",(0,s.jsx)(e.code,{children:"app/Config/Database.js"}),". Everything else in Flowra remains the same."]}),"\n",(0,s.jsx)(e.admonition,{title:"Keep config in one place",type:"tip",children:(0,s.jsxs)(e.p,{children:["Flowra reads from ",(0,s.jsx)(e.code,{children:"app/Config/Database.js"})," for runtime and from ",(0,s.jsx)(e.code,{children:"orm.cli.config.js"})," for CLI migrations, so you only maintain one source of truth."]})})]})}function u(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},8453:(n,e,o)=>{o.d(e,{R:()=>t,x:()=>r});var a=o(6540);const s={},i=a.createContext(s);function t(n){const e=a.useContext(i);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:t(n.components),a.createElement(i.Provider,{value:e},n.children)}}}]);